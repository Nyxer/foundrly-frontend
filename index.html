<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Foundrly — Build Your AI Startup</title>
  <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-purple: linear-gradient(to bottom right, #2d0059, #5e1aa2);
      --bg-gold: linear-gradient(to bottom right, #5f4200, #d4af37);
      --text-light: #ffffff;
      --text-dark: #1a1a1a;
      --accent-purple: #9b59b6;
      --accent-gold: #f1c40f;
      --metallic-purple: linear-gradient(145deg, #5e1aa2, #9b59b6);
      --metallic-gold: linear-gradient(145deg, #f1c40f, #d4af37);
    }
    body.theme-purple { background: var(--bg-purple); color: var(--text-light); }
    body.theme-gold { background: var(--bg-gold); color: var(--text-dark); }
    body {
      font-family: 'Fira Code', monospace;
      margin: 0;
      padding: 2rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      overflow: hidden;
      transition: background 0.5s ease, color 0.5s ease;
    }
    .typewriter-wrapper {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      pointer-events: none;
      z-index: 0;
    }
    .typewriter-chat {
      position: absolute;
      background: rgba(0, 0, 0, 0.6);
      color: #f1c40f;
      padding: 1rem;
      border-radius: 12px;
      font-family: 'Fira Code', monospace;
      font-size: 0.85rem;
      max-width: 320px;
      opacity: 0;
      animation: fadeInOut 6s ease-in-out forwards;
      white-space: pre-wrap;
    }
    @keyframes fadeInOut {
      0% { opacity: 0; }
      10% { opacity: 1; }
      90% { opacity: 1; }
      100% { opacity: 0; }
    }
    .title {
      font-size: 3rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      text-align: center;
      animation: fadeIn 1s ease;
      z-index: 2;
    }
    body.theme-purple .title {
      background: linear-gradient(to right, #a770ef, #cf8bf3, #fdb99b);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    body.theme-gold .title {
      background: linear-gradient(to right, #d4af37, #eacb84);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .slogan {
      font-size: 1.1rem;
      font-weight: 500;
      margin-bottom: 1.5rem;
      animation: fadeIn 1.2s ease-in-out;
      text-align: center;
      z-index: 2;
    }
    .container {
      max-width: 640px;
      width: 100%;
      background: rgba(255,255,255,0.06);
      border-radius: 16px;
      padding: 2rem;
      box-shadow: 0 0 16px rgba(0,0,0,0.5);
      z-index: 1;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    textarea {
      width: 100%;
      height: 140px;
      padding: 1rem;
      border-radius: 10px;
      background: #1a1a1a;
      background-image: var(--metallic-purple);
      border: 1px solid #555;
      color: #f1c40f;
      font-size: 0.95rem;
      font-family: 'Fira Code', monospace;
      resize: none;
      transition: color 0.3s ease;
    }
    body.theme-gold textarea {
      background-image: var(--metallic-gold);
      color: #9b59b6;
    }
    pre {
      background: #111;
      color: #00ffaa;
      padding: 1rem;
      border-radius: 8px;
      overflow-x: auto;
      white-space: pre-wrap;
      font-size: 0.95rem;
      font-family: 'Fira Code', monospace;
    }
    .questions-container input {
      width: 100%;
      margin-bottom: 1rem;
      padding: 0.75rem;
      border-radius: 6px;
      border: 1px solid #444;
      background: #222;
      color: #0f0;
    }
    button {
      margin-top: 1rem;
      padding: 0.75rem 2rem;
      font-size: 1rem;
      font-weight: bold;
      font-family: 'Fira Code', monospace;
      background-image: var(--metallic-purple);
      color: #fff;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      box-shadow: 0 0 12px rgba(0, 0, 0, 0.3);
      transition: background 0.3s ease, transform 0.2s ease;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
    body.theme-gold button {
      background-image: var(--metallic-gold);
      color: #1a1a1a;
    }
    button:hover {
      transform: scale(1.05);
    }
    #loader {
      display: none;
      margin-top: 1rem;
      text-align: center;
    }
    #themeToggleBtn {
      position: fixed;
      bottom: 16px;
      right: 16px;
      padding: 0.5rem 1rem;
      border-radius: 6px;
      font-size: 0.9rem;
      z-index: 3;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body class="theme-purple">
  <div class="typewriter-wrapper" id="typewriterWrapper"></div>
  <div class="title">Foundrly</div>
  <div class="slogan">Your Cofounder Doesn’t Have to Be Human.</div>
  <div class="container">
    <textarea id="ideaInput" placeholder="e.g. An AI that generates Instagram captions for stylists..."></textarea>
    <button onclick="submitIdea()">Build It</button>
    <div id="loader">⏳ Generating...</div>
    <div id="questionsSection" class="questions-container" style="display: none;"></div>
    <button id="submitAnswersBtn" style="display:none" onclick="submitAnswers()">Submit Answers</button>
    <div class="response-area" id="responseArea"></div>
  </div>
  <button id="themeToggleBtn" onclick="toggleTheme()">Toggle Theme</button>

  <script>
    const phrases = [
      "An AI that writes ad copy for local cafes.",
      "A tool that builds landing pages from voice notes.",
      "An assistant that summarizes client feedback.",
      "An AI that auto-generates slogans for fashion brands.",
      "A bot that responds to DMs for digital creators.",
      "An AI that repackages blog posts into carousels.",
      "A caption creator for streetwear drops.",
      "Turn review comments into testimonials.",
      "Generate DM templates for influencer collabs.",
      "From idea to MVP, instantly."
    ];
    function spawnChatBubble(text) {
      const bubble = document.createElement("div");
      bubble.className = "typewriter-chat";
      bubble.style.top = `${Math.random() * 80 + 5}%`;
      bubble.style.left = `${Math.random() * 80 + 5}%`;
      document.getElementById("typewriterWrapper").appendChild(bubble);
      let index = 0;
      const typingInterval = setInterval(() => {
        if (index < text.length) {
          bubble.textContent += text[index];
          index++;
        } else {
          bubble.textContent += ".";
          clearInterval(typingInterval);
          setTimeout(() => bubble.remove(), 1000);
        }
      }, 45);
    }
    setInterval(() => {
      const sample = phrases[Math.floor(Math.random() * phrases.length)];
      spawnChatBubble(sample);
    }, 2500);

    let followUpQuestions = [];
    function toggleTheme() {
      document.body.classList.toggle("theme-purple");
      document.body.classList.toggle("theme-gold");
    }
    async function submitIdea() {
      const idea = document.getElementById("ideaInput").value;
      const responseArea = document.getElementById("responseArea");
      const questionsSection = document.getElementById("questionsSection");
      const loader = document.getElementById("loader");
      document.getElementById("submitAnswersBtn").style.display = "none";
      questionsSection.innerHTML = "";
      questionsSection.style.display = "none";
      responseArea.innerHTML = "";
      loader.style.display = "block";
      try {
        const refineRes = await fetch("https://foundrly-backend-1.onrender.com/api/refine-idea", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ idea })
        });
        const refineData = await refineRes.json();
        loader.style.display = "none";
        if (refineData.status === "clarify") {
          followUpQuestions = refineData.questions;
          responseArea.innerHTML = "<h3>// Need more details:</h3>";
          followUpQuestions.forEach((q, i) => {
            const input = document.createElement("input");
            input.placeholder = q;
            input.id = `answer_${i}`;
            questionsSection.appendChild(input);
          });
          questionsSection.style.display = "block";
          document.getElementById("submitAnswersBtn").style.display = "inline-block";
        } else if (refineData.status === "ready") {
          generateCode(idea);
        } else {
          responseArea.innerHTML = "❗️ Unexpected response format.";
        }
      } catch (err) {
        console.error(err);
        loader.style.display = "none";
        responseArea.innerHTML = "⚠️ Something went wrong.";
      }
    }
    async function submitAnswers() {
      const answers = followUpQuestions.map((_, i) => document.getElementById(`answer_${i}`).value.trim());
      const refinedIdea = document.getElementById("ideaInput").value + ". " + answers.join(" ");
      generateCode(refinedIdea);
    }
    async function generateCode(idea) {
      const responseArea = document.getElementById("responseArea");
      const loader = document.getElementById("loader");
      loader.style.display = "block";
      responseArea.innerHTML = "";
      try {
        const genRes = await fetch("https://foundrly-backend-1.onrender.com/api/generate-code", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            idea,
            target_user: "creators",
            platform: "web app",
            features: ["text generation", "download"]
          })
        });
        const genData = await genRes.json();
        loader.style.display = "none";
        responseArea.innerHTML = `
          <h3>// Tool Summary</h3><pre>${genData.spec}</pre>
          <h3>// Generated Code</h3><pre>${genData.code}</pre>
          <h3>// Setup Instructions</h3><pre>${genData.instructions}</pre>`;
      } catch (err) {
        console.error(err);
        loader.style.display = "none";
        responseArea.innerHTML = "⚠️ Failed to generate tool.";
      }
    }
  </script>
</body>
</html>
